# Chapter 4. RAG으로 다양한 문서 다루기

## 4.1 Document Loaders 알아보기

* RAG의 장점은 다양한 문서를 기반으로 LLM을 활용할 수 있다는 것
* Document 객체: RAG에서 문서를 불러오기 위해 하나의 객체를 새로 정의
* Document 객체는 어떠한 형식의 문서를 불렁도더라도 하나의 통일된 양식으로 통합하여 RAG에 활용할 수 있도록 만들어줌
   * page_content: 문서가 가진 택스트 자체를 의미
   * metadata: 문서의 특성
* 메타 데이터가 있는 이유
   1. RAG 답변의 근거: 문서의 제목, 페이지, 경로 같은 것을 저장하여 답변의 근거로 활용
   2. 메타데이터 기반 필터링

## 4.2 PDF 파일을 Document 로 불러오기

* 정제된 형태의 텍스트 뿐만 아니라 이미지나 테이블 형태의 텍스트도 포함되어 있어서 복잡한 작업이 필요하다.
* 하지만 좋은 라이브러리는 이미 많이 존재하기 때문에 해당 라이브러리를 활용해서 RAG를 구성해볼 수 있다.


## 4.3 RAG으로 다양한 문서 다루기

* 샘플을 보자

## 4.4 문서를 다양하게 자르는 Text Splitters

* 백터 DB의 저장 과정
* RAG 시스템상에서 문서를 불러온 후에 백터 DB에 데이터를 저장
* 문서가 긴 경우 한꺼번에 문서를 백터 DB로 변환화는 것은 지양해야 한다. 
   1. 임베딩 모델의 컨텍스트 윈도우 문제
      * 임베딩 모델의 길이 제한
      * 길이를 초과할 경우 택스트를 잘라낸다.
      * 임베딩하는 모델에 따라서 정해진 길이만큼의 문서만 올바르게 임베딩 변환할 수 있음
      * 텍스트를 잘 분할하는 과정이 필요
   2. LLM의 컨텍스트 윈도우 문제
      * 사용자의 질문과 유사 문서를 합친 텍스트의 토큰 수가 특정 크기 이상 넘어서는 안된다.
   3. '건초더미에서 바늘 찾기' 문제
      * LLM이 주어진 텍스트에서 특정 위치의 정보를 얼마나 정확하게 탐색해내는지 측정
* 문서를 분할하는 방법
   * 적당한 크기로 문서를 분할하는 방법
      * 글자 수 분할하는 방법
      * 재귀적으로 텍스트를 분할하는 방법 
   * 문맥을 파악해 분할하는 방법
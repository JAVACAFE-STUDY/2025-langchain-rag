# RAG으로 다양한 문서 다루기

## 4.1 - Document Loaders 알아보기

### RAG를 위한 Document 객체의 이해

- 1. RAG의 답변 근거

- 2. 메타 데이터 기반 필터링

## 4.2 - PDF 파일을 Document로 불러오기

### PyPDFLoader

드래그해서 긁어올 수 있는 텍스트만 추출 가능
이미지형태 텍스트 + 차트 추출 -> OCR 기능 필요
rapidocr-onnxruntime 라이브러리 사용

### PyPDFium2

OCR 기능은 없지만 빠름

## 4.3 - 여러 파일을 Document로 불러오기

### Word 파일 불러오기, Docx2txtLoader

```python
#Docx2txtLoader 불러오기
from langchain.document_loaders import Docx2txtLoader

#Docx2txtLoader로 워드 파일 불러오기(경로 설정)
loader = Docx2txtLoader(r"../data/[삼성전자] 사업보고서(일반법인) (2021.03.09).docx")

#페이지로 분할하여 불러오기
data = loader.load_and_split()

#첫번째 페이지 출력하기
print(data[12].page_content[:500])
#로드한 워드파일의 메타데이터 확인
print(data[12].metadata)
```

### CSV 파일 불러오기, csv_loader

```python
from langchain.document_loaders.csv_loader import CSVLoader

loader = CSVLoader(file_path=r"../data/mlb_teams_2012.csv")

data = loader.load()

data[0]
```

### PPT 파일 불러오기, UnstructuredPowerPointLoader

```python
import nltk
print(nltk.__version__)

#UnstructuredPowerPointLoader 불러오기
from langchain.document_loaders import UnstructuredPowerPointLoader

#mode=elements를 통해 pptx의 요소별로 Document 객체로 가져오기
loader = UnstructuredPowerPointLoader(r"../data/Copilot-scenarios-for-Marketing.pptx", mode="elements")

#pptx 파일을 분할 로드하기
data = loader.load_and_split()

data[1]

for i in data:
    if i.metadata['page_number'] == 2:
        print(i.metadata['category'])
        print(i.page_content)
        print("\n")

```

### 인터넷 정보 로드하기, WebBaseLoader

```python

from langchain_community.document_loaders import WebBaseLoader
#텍스트 추출할 URL 입력
loader = WebBaseLoader("https://www.espn.com/")
#ssl verification 에러 방지를 위한 코드
loader.requests_kwargs = {'verify':False}
data = loader.load()
data

#[Headline만 가져오기]
import bs4
from langchain_community.document_loaders import WebBaseLoader
#텍스트 추출할 URL 입력
loader = WebBaseLoader("https://www.espn.com/",
                        bs_kwargs=dict(
                            parse_only=bs4.SoupStrainer(
                                class_=("headlineStack top-headlines")
                                                        )
                                        )
                      )
#ssl verification 에러 방지를 위한 코드
loader.requests_kwargs = {'verify':False}
data = loader.load()
data

loader = WebBaseLoader(["https://www.espn.com/", "https://google.com"])
docs = loader.load()
docs
```

### 특정 경로 내의 모든 파일 불러오기, DirectoryLoader

```python
from langchain_community.document_loaders import DirectoryLoader
#첫번째 매개변수로 경로 입력, glob에 해당 경로에서 불러들일 파일의 형식 지정
#*는 모든 문자를 표현하는 와일드카드로, .pdf로 끝나는 모든 파일을 의미함
loader = DirectoryLoader(r'../data/', glob="*.pdf")
docs = loader.load()
[i.metadata['source'] for i in docs]
```

## 4.4 - 문서를 다양하게 자르는 Text Splitters
